"use strict";(self.webpackChunkpayment_split=self.webpackChunkpayment_split||[]).push([[949],{949:function(e,n,t){t.r(n),t.d(n,{default:function(){return _}});var r=t(8214),i=t(5861),s=t(885),a=t(7313),l=t(6157),c=t(2517),o=t(1235),d=t(5448),u=t(8104),h=t(4002),f=t(7597),x=t(40),m=t(2669),p=t(5672),g=t(4940),Z=t(8698),j=t(2937),b=t(2415),v=t(4577),w=t(5814),C=function(){var e=a.useState(),n=(0,s.Z)(e,2),t=n[0],r=n[1],i=a.useState(),l=(0,s.Z)(i,2),c=l[0],o=l[1],d=(0,w.N)(),u=d.getPayments,h=d.txns;return a.useEffect((function(){var e=u(),n=e.getPayments();r(e.getTotal()),o(n)}),[u]),[t,c,h]},y=t(1905),k=t.n(y),S=function(){var e=a.useState(),n=(0,s.Z)(e,2),t=n[0],r=n[1],i=a.useState(),l=(0,s.Z)(i,2),c=l[0],o=l[1];return[t,a.useCallback((function(e){return k()(e).then((function(e){var n=document.createElement("canvas"),t=n.getContext("2d"),i=e.width,s=e.height;n.width=i,n.height=s,t.drawImage(e,0,0);var a=n.toDataURL("image/png",1);return r(a),!0})).catch((function(e){o(e)})),!0}),[]),c]},P=t(6417),E=(0,v.Z)(b.Z)((function(){return{borderRadius:0,padding:"0.475rem",width:"24rem",maxWidth:"100%"}})),I=(0,v.Z)(p.Z)((function(){return{"& > li":{paddingLeft:0,paddingRight:0,fontSize:"small"},marginBottom:"0.875rem"}})),B=a.memo((function(e){var n=e.setImageUrl,t=a.useRef(null),r=S(),i=(0,s.Z)(r,2),l=i[0],c=i[1],o=C(),d=(0,s.Z)(o,3),u=d[0],h=d[1],f=d[2],x=(0,w.N)().toPrice;return a.useEffect((function(){t.current&&null!==h&&void 0!==h&&h.length&&c(t.current)}),[c,h]),a.useEffect((function(){l&&""!==l&&n(l)}),[l,n]),(0,P.jsxs)(E,{ref:t,children:[(0,P.jsx)(m.Z,{borderBottom:1,fontWeight:"bold",borderColor:"text.disabled",children:"Expenses"}),(0,P.jsxs)(I,{dense:!0,children:[f.map((function(e){return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(Z.ZP,{children:(0,P.jsxs)(j.ZP,{container:!0,justifyContent:"space-between",alignItems:"center",children:[(0,P.jsxs)("div",{children:[(0,P.jsxs)(m.Z,{children:[e.friend.name," paid:"]}),e.reason&&(0,P.jsx)(m.Z,{children:(0,P.jsxs)("small",{children:["(",e.reason,")"]})})]}),(0,P.jsx)("div",{children:x(e.amount)})]})},e.id),(0,P.jsx)(g.Z,{})]})})),(0,P.jsxs)(m.Z,{textAlign:"right",width:"100%",fontSize:"small",mt:"0.875rem",children:["Total: ",x(null!==u&&void 0!==u?u:0)]})]}),(0,P.jsx)(m.Z,{borderBottom:1,fontWeight:"bold",borderColor:"text.disabled",children:"Final Txns"}),(0,P.jsx)(I,{dense:!0,children:h&&h.map((function(e){return(0,P.jsx)(Z.ZP,{children:(0,P.jsxs)(j.ZP,{container:!0,justifyContent:"space-between",children:[(0,P.jsxs)("span",{children:[e.from_friend.name," gives"," ",e.to_friend.name,":"]})," ",x(e.amount)]})},e.id)}))}),(0,P.jsx)(m.Z,{textAlign:"center",marginTop:"0.875rem",fontSize:"small",children:(0,P.jsx)("sub",{children:"\u2764\ufe0e swport.github.io/payment-split"})})]})})),R=t(9514),T={"& .MuiDialog-container":{alignItems:"flex-start"}},_=function(e){var n=e.isOpen,t=e.closeModal,m=a.useState(),p=(0,s.Z)(m,2),g=p[0],Z=p[1],j=a.useState(!1),b=(0,s.Z)(j,2),v=b[0],w=b[1];return(0,P.jsxs)(c.Z,{open:n,onClose:t,sx:T,scroll:"paper",children:[(0,P.jsx)(d.Z,{children:g&&(0,P.jsxs)(l.Z,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[(0,P.jsx)(u.Z,{onClick:function(e){e.preventDefault(),g&&(fetch(g).then(function(){var e=(0,i.Z)((0,r.Z)().mark((function e(n){var t,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.blob();case 3:t=e.sent,i="final-txns-".concat((0,R.kb)(),".png"),(0,R.XC)(t,i),w(!1),e.next=15;break;case 9:return e.prev=9,e.t0=e.catch(0),console.log(e.t0),alert("Error occured while downloading image. Please refresh page and try again."),w(!1),e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(n){return e.apply(this,arguments)}}()),w(!0))},disabled:v,children:(0,P.jsx)(h.Z,{})}),(0,P.jsx)(u.Z,{disabled:!0,children:(0,P.jsx)(f.Z,{})}),(0,P.jsx)(u.Z,{disabled:!0,children:(0,P.jsx)(x.Z,{})})]})}),(0,P.jsx)(o.Z,{dividers:!0,children:(0,P.jsx)(l.Z,{marginBottom:"12px",children:(0,P.jsx)(B,{setImageUrl:Z})})})]})}}}]);